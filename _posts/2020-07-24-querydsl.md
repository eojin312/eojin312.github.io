---
title: "query dsl maven 설정하기"     
date: 2020-07-24 13:20:28 -0400
categories: 공부
---

jpa 를 사용하면 이런 식으로 엔티티를 만듭니다.
```java
@Entity
@Getter
public class Item {

    @Id @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column(name = "item_id")
    private Long id;

    @Column
    private String name;

    @Column
    private String price;
}
```

query dsl 을 사용하려면 dependency부터 걸어줍시다.
**pom.xml**
```xml
        <dependency>
            <groupId>com.querydsl</groupId>
            <artifactId>querydsl-jpa</artifactId>
            <version>4.3.1</version>
        </dependency>

        <dependency>
            <groupId>com.querydsl</groupId>
            <artifactId>querydsl-apt</artifactId>
            <version>4.3.1</version>
        </dependency>
```

나중에 설명하겠지만 query dsl 경로도 설정해줘야합니다.
```xml
<build>
        <plugins>
            <plugin>
                <groupId>com.mysema.maven</groupId>
                <artifactId>apt-maven-plugin</artifactId>
                <version>1.1.3</version>
                <executions>
                    <execution>
                        <goals>
                            <goal>process</goal>
                        </goals>
                        <configuration>
                            <outputDirectory>target/generated-sources/java</outputDirectory>
                            <processor>com.querydsl.apt.jpa.JPAAnnotationProcessor</processor>
                        </configuration>
                    </execution>
                </executions>
            </plugin>
        </plugins>
    </build>
```
![스크린샷 2020-07-24 오후 8 29 20](https://user-images.githubusercontent.com/45488643/88387143-d5bb0180-cdec-11ea-9932-dc729a634805.png)

![스크린샷 2020-07-24 오후 8 34 45](https://user-images.githubusercontent.com/45488643/88387312-26caf580-cded-11ea-90b3-bba924e2b288.png)

![스크린샷 2020-07-24 오후 8 35 38](https://user-images.githubusercontent.com/45488643/88387408-58dc5780-cded-11ea-9887-f35adac87253.png)

```java
/**
 * QItem is a Querydsl query type for Item
 */
@Generated("com.querydsl.codegen.EntitySerializer")
public class QItem extends EntityPathBase<Item> {

    private static final long serialVersionUID = 1743385104L;

    public static final QItem item = new QItem("item");

    public final NumberPath<Long> id = createNumber("id", Long.class);

    public final StringPath name = createString("name");

    public final StringPath price = createString("price");

    public QItem(String variable) {
        super(Item.class, forVariable(variable));
    }

    public QItem(Path<? extends Item> path) {
        super(path.getType(), path.getMetadata());
    }

    public QItem(PathMetadata metadata) {
        super(Item.class, metadata);
    }

}
```

```java
@SpringBootTest
@Transactional
class JavaPlaygroundApplicationTests {
    @Test
    void query_dsl_entity_잘되는지_확인() {
        Item item = new Item();
        em.persist(item);

        JPAQueryFactory query = new JPAQueryFactory(em);
        QItem qItem = QItem.item;

        Item result = query
                .selectFrom(qItem)
                .fetchOne();

        Assertions.assertThat(result).isEqualTo(item);
        Assertions.assertThat(result.getId()).isEqualTo(item.getId());
    }
}
```

![스크린샷 2020-07-24 오후 8 41 01](https://user-images.githubusercontent.com/45488643/88387700-03547a80-cdee-11ea-9b61-4159f4fbb924.png)

